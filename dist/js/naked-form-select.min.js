/* Naked Form Select v1.0.13 (https://github.com/developerdayo/naked-form-select)
 * Copyright 2019-2020 Sarah Ferguson
 * Licensed under MIT (https://github.com/developerdayo/naked-form-select/LICENSE) */
"use strict";var nakedFormSelect=function(e,t){var u,p,f,n=0<arguments.length&&void 0!==e?e:"select",o=1<arguments.length&&void 0!==t?t:{},a=o.settings,c=void 0===a?{dropupThreshold:50}:a,r=o.context,i=void 0===r?{value:void 0,queryDocument:!1}:r,l=o.keywordSearch,h=void 0===l?{on:!1,placeholder:void 0}:l,d=o.submitBtn,v=void 0===d?{on:!1,text:void 0}:d;void 0===i.queryDocument?i.queryDocument=!1:i.queryDocument=i.queryDocument;var s=c.dropupThreshold,m={index:function(){setTimeout(function(){u.querySelectorAll("[data-naked-select-id]").forEach(function(e,t){e.setAttribute("data-index",t)})},1)},submitBtn:function(){var e=document.createElement("button");return e.textContent="Submit the form",e.classList.add("naked-submit"),e.addEventListener("click",function(e){e.target.closest("form").submit()}),e},keywordSearchInput:function(){var e=document.createElement("div");e.classList.add("keyword-search-wrap");var t=document.createElement("input");return void 0!==h.placeholder&&t.setAttribute("placeholder",h.placeholder),e.appendChild(t),e},lists:function(){u.querySelectorAll(p).forEach(function(e,t){var n,o=Array.from(e.childNodes).filter(function(e){return"OPTION"===e.nodeName});"true"===e.getAttribute("data-label")&&(n=o[0],o.shift());var a,c=[];o.forEach(function(e){c.push(e.textContent)}),a="true"===e.getAttribute("data-label")?n.textContent:o[0].textContent;var r=document.createElement("button");r.classList.add("toggle-dropdown"),r.setAttribute("aria-label","Click to expand options"),r.textContent=a;var i=document.createElement("div");i.classList.add("options-wrap");var l=document.createElement("ul");l.setAttribute("data-naked-select-list",t),c.forEach(function(e,t){var n=document.createElement("li");n.setAttribute("data-index",t),n.appendChild(document.createTextNode(e)),l.appendChild(n)}),i.appendChild(l);var d=document.createElement("div");if(d.classList.add("naked-form-select-wrap"),d.setAttribute("data-naked-select-id",p),d.setAttribute("data-naked-select",t),d.appendChild(r),d.appendChild(i),e.parentNode.insertBefore(d,e),d.appendChild(e),!0===h.on){var s=m.keywordSearchInput();l.insertAdjacentElement("beforebegin",s)}if(!0===v.on){var u=m.submitBtn();l.insertAdjacentElement("afterend",u),console.log(e)}},m.index())},currentState:function(){u.querySelectorAll("".concat(f,"[data-naked-select] select")).forEach(function(t,e){var n=document.querySelector("".concat(f,"[data-naked-select='").concat(e,"'] .toggle-dropdown"));if(t.multiple){var o,a=Array.from(t.options).filter(function(e){return!0===e.selected}),c=t.options.selectedIndex;a.forEach(function(e){t.previousElementSibling.querySelector("li[data-index='".concat(e.index,"']")).classList.add("selected")}),-1===t.options.selectedIndex?n.textContent=t.options[0].textContent:null!==t.getAttribute("data-multiple-keyword")&&1<a.length?(o=t.getAttribute("data-multiple-keyword")+"s",n.textContent="".concat(a.length," ").concat(o," selected")):(o="items",n.textContent=t.options[c].textContent)}else{var r=t.options.selectedIndex;"true"===t.getAttribute("data-label")&&0===r?n.textContent=t.options[0].textContent:(n.textContent=t.options[r].textContent,t.previousElementSibling.querySelector('li[data-index="'.concat(r,'"]')).classList.add("selected"))}})}},g={triggerEvent:function(e,t){if("createEvent"in document){var n=document.createEvent("HTMLEvents");n.initEvent(t,!1,!0),e.dispatchEvent(n)}},globalClose:function(){document.querySelector("body").addEventListener("click",function(o){for(var a=Array.from(document.querySelectorAll("[data-naked-select]")),e=function(e){if(a[e].classList.contains("open")&&!a[e].contains(o.target)){var t=parseInt(a[e].getAttribute("data-index")),n=a[e].getAttribute("data-naked-select-id");a[e].classList.remove("open"),document.querySelector("[data-naked-select-id='".concat(n,"'][data-index='").concat(t,"'] .options-wrap")).style.height="0",setTimeout(function(){a[e].classList.remove("dropup")},255)}},t=0;t<a.length;t++)e(t)})},toggle:function(){u.querySelectorAll("".concat(f,"[data-naked-select] .toggle-dropdown")).forEach(function(e,t){var a=u.querySelector("".concat(f,"[data-naked-select='").concat(t,"']")),c=u.querySelector("".concat(f,"[data-naked-select='").concat(t,"'] .options-wrap"));c.style.height="0",e.addEventListener("click",function(e){e.preventDefault();var t=c.scrollHeight;if(a.classList.contains("open"))a.classList.remove("open"),c.style.height="0",e.target.parentNode.classList.remove("dropup");else{a.classList.add("open"),c.style.height="".concat(t,"px");var n=window.innerHeight,o=window.scrollY;n-(window.scrollY+e.target.getBoundingClientRect().top+e.target.offsetHeight)+o<s&&(e.target.parentNode.classList.add("dropup"),e.target.nextSibling.style.bottom="".concat(e.target.offsetHeight,"px"))}})},g.globalClose())},select:function(){u.querySelectorAll("".concat(f,"[data-naked-select] li")).forEach(function(s,e){s.addEventListener("click",function(){var e=s.getAttribute("data-index"),t=s.textContent,n=s.parentNode.getAttribute("data-naked-select-list"),o=u.querySelector("".concat(f,"[data-naked-select='").concat(n,"'] select")),a=u.querySelector("".concat(f,"[data-naked-select='").concat(n,"'] .options-wrap")).scrollHeight;o.options[parseInt(e)].selected=!0,g.triggerEvent(o,"change");var c=u.querySelector("".concat(f,"[data-naked-select='").concat(n,"'] .toggle-dropdown"));if(o.multiple){s.classList.contains("selected")?(s.classList.remove("selected"),o.options[parseInt(e)].selected=!1):(s.classList.add("selected"),o.options[parseInt(e)].selected=!0);var r,i=Array.from(o.options).filter(function(e){return!0===e.selected});if(1<i.length)i.forEach(function(e){o.previousElementSibling.querySelector('li[data-index="'.concat(e.index,'"]')).classList.add("selected")}),r=null!==o.getAttribute("data-multiple-keyword")?o.getAttribute("data-multiple-keyword")+"s":"items",c.textContent="".concat(i.length," ").concat(r," selected");else 1===i.length&&(c.textContent=i[0].text);-1===o.options.selectedIndex&&(c.textContent=o.options[0].textContent)}else{var l=u.querySelector("".concat(f,"[data-naked-select='").concat(n,"']")),d=u.querySelector("".concat(f,"[data-naked-select='").concat(n,"'] .options-wrap"));l.classList.contains("open")?(l.classList.remove("open"),d.style.height="0"):(l.classList.add("open"),d.style.height="".concat(a,"px")),u.querySelectorAll("".concat(f,"[data-naked-select='").concat(n,"'] li")).forEach(function(e){e.classList.remove("selected")}),s.classList.contains("selected")?s.classList.remove("selected"):s.classList.add("selected"),c.textContent=t}})})},keywordSearch:function(){!0===h.on&&(u.querySelectorAll(f).forEach(function(e){e.setAttribute("keywordSearch","on")}),u.querySelectorAll(p).forEach(function(e,c){var t=[],r=Array.from(e.childNodes).filter(function(e){return"OPTION"===e.nodeName});r.forEach(function(e){t.push(e.textContent)});var n=e.previousElementSibling.childNodes[0].childNodes[0],i=e.previousElementSibling.childNodes[1],l=u.querySelectorAll("[data-naked-select-id='".concat(p,"'] .options-wrap li"));l.forEach(function(e){e.classList.add("match")}),n.addEventListener("input",function(e){var t=e.target.value.toLowerCase(),n=r.filter(function(e){if(e.textContent.toLowerCase().match(t))return e});l.forEach(function(e){e.classList.remove("match")}),n.forEach(function(t){l.forEach(function(e){parseInt(e.getAttribute("data-index"))===t.index&&e.classList.add("match")})});var o=i.offsetHeight,a=u.querySelector("".concat(f,"[data-naked-select='").concat(c,"'] .keyword-search-wrap")).offsetHeight;u.querySelector("".concat(f,"[data-naked-select='").concat(c,"'] .options-wrap")).style.height=o+a+"px"})}))}};u=void 0!==i.value&&!1===i.queryDocument?i.value:void 0!==i.value&&!0===i.queryDocument?document.querySelector(i.value):document,f="[data-naked-select-id='".concat(p=n,"']"),m.lists(),m.currentState(),g.toggle(),g.select(),g.keywordSearch()};